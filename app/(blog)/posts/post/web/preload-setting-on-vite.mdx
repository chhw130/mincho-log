---
title: Viteì—ì„œ preload pluginí•¨ìˆ˜ ë§Œë“¤ê¸°
date: 2025-08-20
description: ìµœê·¼ì— Webpackì—ì„œ Viteë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ë©´ì„œ Webpackê¸°ë°˜ ì„¸íŒ…ë„ Viteë§ì¶°ì„œ ë³€ê²½í•˜ê²Œ ë˜ì—ˆì–´ìš”. ê·¸ë˜ì„œ ì´ì „ì— font preloadë¥¼ í•´ê²°ì„ ìœ„í•œ í”ŒëŸ¬ê·¸ì¸ë„ ì œê±°í•˜ê³  Viteì— ë§ì¶°ì„œ ìƒˆë¡œ ì„¸íŒ…ì„ í•´ì•¼í–ˆì–´ìš”.
category: JavaScript
thumbnail: /images/post/web/preload-setting-on-vite/rollup.png
---

ìµœê·¼ì— Webpackì—ì„œ Viteë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ë©´ì„œ Webpackê¸°ë°˜ ì„¸íŒ…ë„ Viteë§ì¶°ì„œ ë³€ê²½í•˜ê²Œ ë˜ì—ˆì–´ìš”. í”„ë¡œì íŠ¸ê°€ Vue-CLIê¸°ë°˜ìœ¼ë¡œ ëŒì•„ê°”ë˜ì§€ë¼ eslintë‚˜ ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ ì„¤ì •ë„ ìµœì‹  ë²„ì „ì— ë§ì¶”ê³  í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ì–´ìš”.

ê·¸ë˜ì„œ ì´ì „ì— font preloadë¥¼ í•´ê²°ì„ ìœ„í•œ í”ŒëŸ¬ê·¸ì¸ë„ ì œê±°í•˜ê³  Viteì— ë§ì¶°ì„œ ìƒˆë¡œ ì„¸íŒ…ì„ í•´ì•¼í–ˆì–´ìš”.

# ì™¸ë¶€ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í• ê¹Œ..?
Viteì—ì„œëŠ” ê³µì‹ì ìœ¼ë¡œ preloadë¥¼ ìœ„í•œ í”ŒëŸ¬ê·¸ì¸ì„ ì œê³µí•˜ê³  ìˆì§€ëŠ” ì•Šì•˜ì–´ìš”. `vite-plugin-html`ì´ë¼ëŠ” í”ŒëŸ¬ê·¸ì¸ì´ ì¡´ì¬í•˜ê³  ê´€ë ¨ì˜ˆì œë„ ì‰½ê²Œ ì°¾ì•„ ë³¼ ìˆ˜ ìˆê¸°ëŠ” í–ˆì–´ìš”.

**í•˜ì§€ë§Œ ì €ëŠ” ì´ ì™¸ë¶€ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šê¸°ë¡œ í–ˆì–´ìš”.** ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ì•„ìš”.
1. ìµœì¢… releaseëœì§€ 2ë…„ì •ë„ê°€ ë˜ì–´, ê´€ë¦¬ê°€ ë˜ëŠ”ê±° ê°™ì§€ ì•Šì•˜ì–´ìš”. (issueë¡œ deprecatedë˜ì—ˆë‹¤ëŠ” ê²½ê³  ë©”ì‹œì§€ê°€ ë…¸ì¶œë˜ê³  ìˆì–´ìš”.)
2. Viteì—ì„œ ì œê³µí•˜ëŠ” ê¸°ë³¸ í”ŒëŸ¬ê·¸ì¸ APIê°€ ê°•ë ¥í–ˆì–´ìš”.
3. ë‹¨ìˆœí•œ ì™¸ë¶€ ì˜ì¡´ì„±ì„ ì„¤ì¹˜í•˜ê³  ì‹¶ì§€ëŠ” ì•Šì•˜ì–´ìš”.

ì´ë²ˆì— Viteë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ëŠ” ê³¼ì •ì—ì„œ ì™¸ë¶€ ì˜ì¡´ì„± ë²„ì „ì„ ë§ì¶”ê³  ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ëœì–´ë‚´ëŠ”ë° ê³ ìƒí–ˆë˜ í„°ë¼, ì„œë“œ íŒŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ëŠ” ë°°ì œí•˜ê³ ì í–ˆì–´ìš”.


# Vite í”ŒëŸ¬ê·¸ì¸ API

> https://ko.vite.dev/guide/api-plugin.html
https://rollupjs.org/plugin-development/


í”ŒëŸ¬ê·¸ì¸ë“¤ì˜ ì •ë³´ëŠ” ê³µì‹ ë¬¸ì„œì— ì˜ ì •ë¦¬ê°€ ë˜ì—ˆì–´ìš”.
ViteëŠ” í”„ë¡œë•ì…˜ ëª¨ë“œì¼ ë•Œ Rollupì„ ê¸°ë°˜ìœ¼ë¡œ ë²ˆë“¤ë§í•˜ê¸° ë•Œë¬¸ì—, Rollupì˜ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.

Rollupì˜ Pluginì€ `properties`, `build hooks`, `output generation hooks` ì¤‘ í•˜ë‚˜ ì´ìƒì„ í¬í•¨í•˜ëŠ” ê°ì²´ì—¬ì•¼í•´ìš”. ë³¸ê²©ì ìœ¼ë¡œ Vite í”ŒëŸ¬ê·¸ì¸ì„ êµ¬ì„±í•˜ê¸° ìœ„í•´ êµ¬ì„±ìš”ì†Œë¥¼ í•œë²ˆì”© ì‚´í´ë³´ê³  ê°€ì•¼í•´ìš”.


## properties

propertiesì˜ ê²½ìš° ë§ ê·¸ëŒ€ë¡œ ì†ì„±ì„ ë§í•´ìš”. ì°¸ê³ ë¡œ í”ŒëŸ¬ê·¸ì¸ ì‘ì„± ê·œì¹™ìœ¼ë¡œ ì¸í•´ nameì†ì„±ì€ `-`ìœ¼ë¡œ êµ¬ë¶„í•´ìš”.


```javascript
export default function examplePlugin() {
  return {
    name: 'example-plugin',     // í•„ìˆ˜: í”ŒëŸ¬ê·¸ì¸ ì´ë¦„
    version: '1.0.0',          // ì„ íƒ: ë²„ì „
    meta: {                    // ì„ íƒ: ë©”íƒ€ë°ì´í„°
      rollupVersion: '^4.0.0'
    }
  }
}
```


## build hooks

build hooksëŠ” ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ì™€ ìƒí˜¸ ì‘ìš©í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ë‹¨ê³„ì—ì„œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì—ìš”.

<Image src="/images/post/web/preload-setting-on-vite/build-hooks-mermaid.png"
  objectFit="contain"
  fill
  height="800px"
/>

ë‹¤ìŒê³¼ ê°™ì´ ë‹¤ì´ì–´ê·¸ë¨ì„ í†µí•´ íë¦„ì„ íŒŒì•…í•  ìˆ˜ ìˆì–´ìš”.
ì´ë¥¼ ê´€ë ¨ hookì„ ì“°ëŠ” ê°„ë‹¨í•œ ì˜ˆì œë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì‚´í´ë³¼ ìˆ˜ ìˆì–´ìš”.

```javascript
export default function buildHooksPlugin() {
  return {
    name: 'build-hooks-example',
    
    // 1. ë¹Œë“œ ì‹œì‘ ì‹œ
    buildStart(inputOptions) {
      console.log('ë¹Œë“œê°€ ì‹œì‘ë©ë‹ˆë‹¤!', inputOptions)
    },
    
    // 2. ëª¨ë“ˆ ID ì°¾ê¸°
    resolveId(id, importer) {
      if (id === 'virtual:my-module') {
        return { id : virtual:my-module } // ê°€ìƒ ëª¨ë“ˆ ìƒì„±
      }
      return null 
    },
    
    // 3. resolveIdì—ì„œ ì°¾ì€ ëª¨ë“ˆ ë¡œë”©
    load(id) {
      if (id === 'virtual:my-module') {
        return 'export const msg = "Hello from virtual module!"'
      }
      return null
    },
    
    // 4. ì½”ë“œ ë³€í™˜
    transform(code, id) {
      if (id.endsWith('my-module')) {
        return code.toUpperCase()
      }
      return null
    }
  }
}

// ê²°ê³¼: export const msg = "HELLO FROM VIRTUAL MODULE!" 
```

ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ ë³´ë©´ ê° Build hooksì˜ íë¦„ì— ë”°ë¼ ë™ì‘ì„ ì •ì˜í•  ìˆ˜ ìˆì–´ìš”. 
ì´ ê³¼ì •ì„ í†µí•´ Build hooksëŠ” `ë²ˆë“¤ë§ ì „ì— ê° ëª¨ë“ˆì„ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€`ë¥¼ ì •ì˜í•´ìš”.


## Output Generation Hooks

Output Generation HooksëŠ” ë²ˆë“¤ë§ ëœ ê²°ê³¼ë¬¼ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆì–´ìš”. ê·¸ë¦¬ê³  ë¹Œë“œ ê³¼ì •ì—ì„œ ìˆ˜ì •í•  ìˆ˜ë„ ìˆì–´ìš”.


<Image src="/images/post/web/preload-setting-on-vite/output-generation-hooks-mermaid.png"
  objectFit="contain"
  fill
  height="1000px"
/>

ì´ ê³¼ì •ì„ ê°„ë‹¨íˆ ì„¤ëª…í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì•„ìš”.

Output generationì˜ í° ê·¸ë¦¼ì—ì„œì˜ ê³¼ì •
1. outputOptions : ì¶œë ¥ì„ ì–´ë–»ê²Œ ì„¤ì •í–ˆëŠ”ì§€ í™•ì¸í•´ìš”.
2. renderStart : ì—¬ê¸°ì„œ ë Œë”ë§ì„ ì‹œì‘í•´ìš”.
3. ë Œë”ë§ ê³¼ì •
   â”œâ”€â”€ renderChunk ê° ë²ˆë“¤ë§ ëª¨ë“ˆì˜ ì²­í¬ë¥¼ ë Œë”ë§í•´ìš”.
   â””â”€â”€ resolveDynamicImport ë™ì  importì²˜ë¦¬ ëœ ì²­í¬ë¥¼ ë Œë”ë§í•´ìš”.
4. generateBundle - ëª¨ë“  ë Œë”ë§ ì™„ë£Œ í›„ ìµœì¢… ë²ˆë“¤ì„ ìƒì„±í•´ìš”.


<Callout status='warning'>
renderStart
ë²ˆë“¤ë§ ê³¼ì •ì—ì„œ ì‚¬ìš©ëœ `ë Œë”ë§`ì´ë€ ìš©ì–´ëŠ” ëª¨ë“ˆì— ëŒ€í•œ ì˜ì¡´ì„± ê·¸ë˜í”„ ìƒì„± -> ìµœì¢… JavaScript ë²ˆë“¤ë§ íŒŒì¼ ìƒì„± ê³¼ì •ì„ ì˜ë¯¸í•´ìš”. ì¦‰ ì—¬ê¸°ì„œì˜ ë Œë”ë§ì€ ë¸Œë¼ìš°ì € ë Œë”ë§ì´ë‚˜ Reactì—ì„œ ë Œë”ë‹¨ê³„ì™€ ì»¤ë°‹ë‹¨ê³„ë¡œ ë‚˜ë‰˜ëŠ” ë Œë”ë§ ê°œë…ê³¼ëŠ” ì•„ì˜ˆ ë‹¬ë¼ìš”.
ê°™ì€ ìš©ì–´ë¼ë„ ë¬¸ë§¥ì— ë”°ë¼ ë‹¤ë¥´ê²Œ í•´ì„ë  ìˆ˜ ìˆì–´ìš”.
</Callout>

ì„œë¡ ì´ ê¸¸ì—ˆì§€ë§Œ.. ì´ ê³¼ì •ì—ì„œ ì €ëŠ” ê²°êµ­ preloadí•  ìˆ˜ ìˆëŠ” scriptë¥¼ ìµœì¢… ë²ˆë“¤ë§ ê²°ê³¼ë¬¼ì— ì‚½ì…í•´ì•¼í–ˆê³ , rollupì˜ ë²ˆë“¤ë§ê³¼ì •ì˜ í° ê·¸ë¦¼ì„ ë´ì•¼í–ˆì–´ìš”.


# Preload Pluginë§Œë“¤ê¸°

Rollupì˜ ê° ê³¼ì •ì˜ í”ŒëŸ¬ê·¸ì¸ì„ ë³´ê³  `Output generationê³¼ì •`ì—ì„œ í”ŒëŸ¬ê·¸ì¸ ë¡œì§ì„ ì„¤ì •í•˜ë©´ ë˜ê² ë‹¤ê³  ìƒê°í•´ìš”. ì™œëƒí•˜ë©´ preloadí•˜ê³ ìí•˜ëŠ” fontíŒŒì¼ì€ í•œë²ˆ ë²ˆë“¤ë§ë˜ì—ˆì„ ë•Œ hashë¥¼ ë¶™ì–´ì„œ ìƒì„±í•˜ê¸° ë•Œë¬¸ì— ì´ íŒŒì¼ì„ ì°¾ê¸° ìœ„í•´ì„œëŠ” ìµœì¢…ë²ˆë“¤ë§ íŒŒì¼ì„ íƒìƒ‰í•´ì•¼í•´ìš”.


<Image src="/images/post/web/preload-setting-on-vite/hashed-bundling-font-file.png"
  objectFit="contain"
  fill
  height="250px"
/>

> ë²ˆë“¤ë§ ì´í›„ í•´ì‰¬í™”ëœ fontíŒŒì¼

Output generationê³¼ì •ì—ì„œì˜ `generateBundle` í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•´ ìµœì¢… ë²ˆë“¤ë§ ëœ íŒŒì¼ì—ì„œ ê´€ë ¨ fontíŒŒì¼ì„ ì°¾ì•˜ì–´ìš”.

```javascript
function fontPreloadPlugin(fontRegex) {
  let fontUrl = "";
  return {
    name: "font-preload",
    apply: "build",
    generateBundle(_, bundle) {
      for (const fileName in bundle) {
        if (fontRegex.test(fileName)) {
          fontUrl = `/${fileName}`;
          break;
        }
      }
    }
  }
}
```

generateBundleì˜ ë‘ë²ˆì§¸ ì¸ìëŠ” ìµœì¢… ë²ˆë“¤ë§ëœ ê²°ê³¼ë¬¼ë“¤ì´ ì¶œë ¥ë˜ìš”. ì—¬ê¸°ì„œ í•´ë‹¹ font íŒŒì¼ì„ ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ì°¾ì„ ë•Œê¹Œì§€ forë¬¸ì„ ì¨ì¤¬ì–´ìš”.

ì´ì œ ë°œê²¬ëœ font íŒŒì¼ì„ htmlíŒŒì¼ì— ì£¼ì…ì‹œì¼œì£¼ë©´ë˜ìš”. ì´ë¥¼ ìœ„í•´ `transformIndexHtml`ì´ë¼ëŠ” Viteì „ìš© í›…ì„ ì‚¬ìš©í–ˆì–´ìš”. ì´ í›…ì€ `index.html`ê³¼ ê°™ì€ ì§„ì…ì ì´ ë˜ëŠ” htmlíŒŒì¼ì„ ë³€í™˜í•˜ëŠ” í›…ì´ì—ìš”. ìµœì¢… htmlíŒŒì¼ì„ ë§Œë“œëŠ” ê³¼ì •ì—ì„œ linkíƒœê·¸ë¥¼ ì¶”ê°€í•´ìš”.

`transformIndexHtml`ì€ `{ html, tags }`í˜•íƒœë¡œ ê°ì²´ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆì–´ìš”. `html`ì€ ìµœì¢… htmlê²°ê³¼ë¬¼ì„ ì˜ë¯¸í•˜ë©°, `tag`ì—ëŠ” ì¶”ê°€í•˜ê³ ìí•˜ëŠ” tagë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆì–´ìš”.




```javascript
function fontPreloadPlugin(fontRegex) {
  let fontUrl = "";
  return {
    name: "font-preload",
    //...ìƒëµ
    transformIndexHtml(html) {
      if (fontUrl) {
        return {
          html,
          tags: [
            {
              tag: "link",
              injectTo: "head",
              attrs: {
                rel: "preload",
                href: fontUrl,
                as: "font",
                type: "font/woff2",
                crossorigin: "",
              },
            },
          ],
        };
      }
      return html;
    },
  };
}
```

```typescript
// í•´ë‹¹ í›…ì˜ return ì‹œê·¸ë‹ˆì²˜
interface HtmlTagDescriptor {
  tag: string
  attrs?: Record<string, string | boolean>
  children?: string | HtmlTagDescriptor[]
  injectTo?: 'head' | 'body' | 'head-prepend' | 'body-prepend'
}
```


# ìµœì¢… ì‘ì„± í”ŒëŸ¬ê·¸ì¸

```javascript
/**
 * preload linkë¥¼ ì‚½ì…í•˜ëŠ” Vite í”ŒëŸ¬ê·¸ì¸
 */
function fontPreloadPlugin(fontRegex) {
  let fontUrl = "";
  return {
    name: "font-preload",
    generateBundle(_, bundle) {
      for (const fileName in bundle) {
        if (fontRegex.test(fileName)) {
          fontUrl = `/${fileName}`;
          break;
        }
      }
    },
    transformIndexHtml(html) {
      if (fontUrl) {
        return {
          html,
          tags: [
            {
              tag: "link",
              injectTo: "head",
              attrs: {
                rel: "preload",
                href: fontUrl,
                as: "font",
                type: "font/woff2",
                crossorigin: "",
              },
            },
          ],
        };
      }
      return html;
    },
  };
}
```

<Image src="/images/post/web/preload-setting-on-vite/preload-tag.png"
  objectFit="contain"
  fill
  height="150px"
/>

ë¹Œë“œëœ applicationì—ì„œë„ í•´ë‹¹ tagê°€ ìµœì¢… htmlíŒŒì¼ì— í¬í•¨ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆì–´ìš”. ë³„ë„ì˜ íŒ¨í‚¤ì§€ë¡œ êµ¬ì„±í•˜ê±°ë‚˜ í™•ì¥ì„±ìˆëŠ” í”ŒëŸ¬ê·¸ì¸(preloadí”ŒëŸ¬ê·¸ì¸)ìœ¼ë¡œ ë§Œë“¤ìˆ˜ë„ ìˆì§€ë§Œ í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œëŠ” í¬ê²Œ ì¬ì‚¬ìš©ë  í•„ìš”ëŠ” ì—†ë‹¤ê³  ëŠê»´ì € `vite.config.js`ì— ì§ì ‘ ì‘ì„±í–ˆì–´ìš”.


> Reference
> - https://web.dev/articles/optimize-webfont-loading?hl=ko#the_font_loading_api
> - https://ko.vite.dev/guide/api-plugin.html
> - https://rollupjs.org/plugin-development/

<Callout status='success'>
[ë§í¬ë“œì¸](https://www.linkedin.com/in/%ED%98%84%EC%9A%B0-%EC%B5%9C-71b487282/)ìœ¼ë¡œ ì´ì•¼ê¸°ë¥¼ ì£¼ê³  ë°›ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´ ì–¸ì œë“ ì§€ í¸í•˜ê²Œ ì—°ë½ì£¼ì„¸ìš”. ğŸ™‡â€â™‚ï¸
</Callout>